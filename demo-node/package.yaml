id: demo-node
name: Demo Node
author: Tenzir
author_icon: https://raw.githubusercontent.com/tenzir/library/main/.tenzir.svg
package_icon: https://raw.githubusercontent.com/tenzir/library/main/demo-node/package.svg

description: |
  This package provides sample data and example pipelines to play with. Every
  cloud-hosted demo node has this package installed by default.

  The package imports a Zeek and Suricata logs that run on a PCAP from a
  modified version of the M57-Patents dataset, a forensics research corpus
  generated by Woods at al. in 2001. We enhanced this PCAP by also injecting
  traffic from malware samples.
categories:
- sources

examples:
  - name: Show all Suricata alerts
    description: |
      Use the `where` operator to zero in on one particular schema.
    definition: |
      export
      where @name == "suricata.alert"

  - name: View a sample of Zeek TSV logs
    description: |
      The `taste` operator returns up to the specified number of events per
      schema. We use it to show some of all Zeek TSV logs to get an idea of our
      dataset.
    definition: |
      export
      where "zeek" in @name
      taste 10

  - name: Identify long-running connections
    description: |
      Use the `where` operator with a more complex expression to identify
      long-running connections in a specific CIDR subnet.
    definition: |
      export
      where @name == "zeek.conn"
      where id.orig_h in 10.10.5.0/25
      where orig_bytes > 1Mi or duration > 30min

  - name: Identify top hitters
    description: |
      Use the `top` operator to see the top 5 hitters in Zeek notice logs.
    definition: |
      export
      where @name == "zeek.notice"
      top msg
      head 5
