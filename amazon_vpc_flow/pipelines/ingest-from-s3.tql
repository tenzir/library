---
name: Ingest VPC Flow Logs from S3 (default format)
description: |
  Ingests VPC Flow Log files in the default format from an S3 bucket,
  parses them, and publishes events to the 'amazon' topic.

  For custom log formats, use `amazon_vpc_flow::parse` with your header.
---

from_file "{{ inputs.s3-bucket-url }}", watch=true, remove={{ inputs.remove-inputs }} {
  decompress_gzip
  amazon_vpc_flow::parse_v2
}
publish "amazon"
