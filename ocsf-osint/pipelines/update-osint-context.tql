---
name: Update the OCSF OSINT lookup table
description: |
  Updates the `ocsf-osint` context by subscribing to **OSINT Inventory
  Info** events.
---

let $topic = "{{ inputs.osint-input-topic }}"
subscribe $topic
where @name == "ocsf.osint_inventory_info"
unroll osint
context::update "ocsf-osint",
  key=osint.value,
  value=osint,
  create_timeout={{ inputs.max-ioc-age }}
