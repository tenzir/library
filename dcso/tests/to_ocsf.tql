// Start with unrolled events.
from_file f"{env("TENZIR_INPUTS")}/sample.json" {
  read_json raw=true
}

// Type cleaning copied from dcso::tie::fetch
created = created.time()
modified = modified.time()
if (firstSeen? != null) {
  firstSeen = firstSeen.time()
}
if (lastSeen? != null) {
  lastSeen = lastSeen.time()
}
lastFeedOccurence = lastFeedOccurence.time()

// The tested operator.
dcso::tie::to_ocsf

// Ensure OCSF compliance.
ocsf::cast

// Fix non-determinism.
time = 2025-01-01
