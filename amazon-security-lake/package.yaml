---
id: amazon-security-lake
name: Amazon Security Lake
author: Tenzir
author_icon: https://raw.githubusercontent.com/tenzir/library/main/.tenzir.svg
package_icon: https://raw.githubusercontent.com/tenzir/library/main/amazon-security-lake/package.svg
description: |
  [Amazon Security Lake](https://aws.amazon.com/security-lake/) automatically
  centralizes security data from cloud, on-premises, and custom sources.

  This package provides pipelines for writing OCSF events to Amazon Security
  Lake using the S3-based ingestion format.

  *NOTE*: Before you can write events to the Security Lake, you must configure
  a *custom source* per event type in Security Lake and ensure the Tenzir Node
  has write permissions to the S3 bucket in the respective source directory. The
  package assumes that you adhere to the Tenzir naming scheme `tnz-ocsf-XXXX` where
  `XXXX` is the class UID of an OCSF event class.
categories:
  - destinations

inputs:
  input-topic:
    name: Input topic
    description: Topic to subscribe to for OCSF events
    default: ocsf
  bucket-name:
    name: S3 bucket name
    description: The name of the S3 bucket in Security Lake (e.g., `aws-security-data-lake-eu-west-2-lake-abcdefghijklmnopqrstuvwxyz1234`
  region:
    name: AWS Region
    description: AWS region where the Security Lake is deployed
  account-id:
    name: AWS Account ID
    description: The ID of the AWS account that hosts the Security Lake instance.
  external-id:
    name: AWS External ID
    description: The external ID for all custom sources.
  timeout:
    name: Timeout
    description: Timeout for writing to Security Lake
    default: 5m

examples:
  - name: Send OCSF Network Activity events with cross-account role
    description: |
      Send OCSF Network Activity events to Security Lake using cross-account
      role assumption with `role` and `external_id` parameters.
    definition: |
      let $lake_source_url = "s3://your-security-lake-bucket/ext/tnz-ocsf-4001"
      let $lake_region = "us-east-1"
      let $lake_account_id = "123456789012"
      let $role_arn = "arn:aws:iam::123456789012:role/SecurityLakeRole"
      let $external_id = "unique-external-id-123"

      subscribe "ocsf"
      where @name == "ocsf.network_activity"
      ocsf::apply
      to_amazon_security_lake $lake_source_url,
        region=$lake_region,
        account_id=$lake_account_id,
        role=$role_arn,
        external_id=$external_id
