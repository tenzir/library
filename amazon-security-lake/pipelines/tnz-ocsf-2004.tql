---
name: "OCSF Detection Finding â†’ Amazon Security Lake"
description: |
  Sends OCSF Detection Finding events to Amazon Security Lake
disabled: true
---

let $custom_source = "tnz-ocsf-2004"
let $account_id = "{{ inputs.account-id }}"
let $region = "{{ inputs.region }}"
let $bucket = "{{ inputs.bucket-name }}"
let $role = f"arn:aws:iam::{$account_id}:role/AmazonSecurityLake-Provider-{$custom_source}-{$region}"
subscribe "{{ inputs.input-topic }}"
where @name == "ocsf.detection_finding"
ocsf::apply
to_amazon_security_lake f"s3://{$bucket}/ext/{$custom_source}",
  account_id=$account_id,
  region=$region,
  role=$role,
  external_id="{{ inputs.external-id }}",
  timeout={{ inputs.timeout }}
