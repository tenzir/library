id: zscaler
name: Zscaler
author: Tenzir
author_icon: https://raw.githubusercontent.com/tenzir/library/main/author.svg
package_icon: https://raw.githubusercontent.com/tenzir/library/main/zscaler/zscaler.svg

description: |
  [Zscaler's Nanolog Streaming Service (NSS)](https://help.zscaler.com/zia/understanding-nanolog-streaming-service) is a family of products that enable Zscaler cloud communication with third-party security solution devices for exchanging event logs.
  
  This package simplifies the process of integrating and managing logs generated by Zscaler. You can either use Zscaler's Cloud NSS or deploy an on-prem NSS server to obtain the logs.

inputs:
  listen-endpoint:
    name: Listen endpoint
    description: IP-adress of the Cloud NSS feed
    type: string
    default: 0.0.0.0
  port:
    name: Port
    description: Port of the Cloud NSS feed
    type: string
    default: 8088
  splunk_token:
    name: Splunk Token
    description: Token for authenticating to the Splunk HEC endpoint
    type: string
    default: YOUR_TOKEN
  nss-server:
    name: NSS server
    description: URL for NSS server instance
    type: string
    default: tcp://0.0.0.0:514

pipelines:
  onboard-from-cloud-nss-feed:
    name: Onboard Zscaler Logs from Cloud NSS feed
    description: A pipeline for inserting Zscaler Syslogs from a Cloud NSS feed.
    definition: |
      from_fluent_bit "splunk", options={
        listen: {{ listen-endpoint }},
        port: {{ port }},
        splunk_token: {{ splunk_token }},
      }
      publish "zscaler"
  onboard-from-nss-server:
    name: Onboard Zscaler Logs over TCP from on-prem NSS Server
    description: A pipeline for inserting Zscaler Syslogs over TCP from an on-prem NSS Server.
    definition: |
      // tql2
      from "{{ nss-server }}" {
        read_syslog
      }
      publish "zscaler"
 